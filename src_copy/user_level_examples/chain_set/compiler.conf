
/* 
* Title: chain_5.conf
* Description: chain #5 is the complex chain example.
*/

flow traffic_1 = [{'dst_ip' : '1.0.1.3', {'src_ip' : '1.0.1.1', 'src_ip' : '1.0.1.3'}}, {'dst_ip' : '1.0.1.4'}]
flow traffic_2 = [{'dst_ip' : '1.0.1.9'}, {'src_ip' : '1.0.1.1'}]
flow traffic_3 = [{'dst_ip' : '1.0.1.8'}, {'src_ip' : '1.0.1.1'}]
flow traffic_4 = [{'dst_ip' : '1.0.1.5'}, {'dst_ip' : '1.0.1.6'}, {'dst_ip' : '1.0.1.7'}]
flow traffic_5 = [{'dst_ip' : '1.0.1.11'}]
flow traffic_6 = [{'dst_ip' : '1.0.1.12'}]
flow traffic_7 = [{'dst_ip' : '1.0.1.13'}]
flow traffic_8 = [{'dst_ip' : '1.0.1.14'}]
flow traffic_9 = [{'dst_ip' : '1.0.1.14'}]

chain sp_1 = BPF() -> [ {'flowspec':[{'dst_ip': '1.0.1.7'}], 'nfchain' : NAT()}, {'flowspec':[{'dst_ip': '1.0.1.8'}], 'nfchain': NAT()}, {'flowspec':[{'dst_ip': '1.0.1.9'}], 'nfchain': NAT()}]  -> IPv4Forward()

chain sp_2 = ACL()-> AESCBC()-> IPv4Forward

chain sp_3 = TrafficShaper()->NAT()->IPv4Forward()

chain sp_4 = TrafficShaper()->NAT()->IPv4Forward()

chain sp_6 = TrafficShaper()->NAT()->IPv4Forward()

chain sp_5 = TrafficShaper()->NAT()->IPv4Forward()

chain sp_7 = TrafficShaper()->NAT()->IPv4Forward()

chain sp_8 = TrafficShaper()->NAT()->IPv4Forward()

traffic_1 : sp_1
traffic_2 : sp_2
traffic_3 : sp_3
traffic_4 : sp_4
traffic_5 : sp_5
traffic_6 : sp_6
traffic_7 : sp_7
traffic_8 : sp_8
